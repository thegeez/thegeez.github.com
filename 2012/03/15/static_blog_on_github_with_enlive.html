<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>thegeez blog - Simple static blog with Clojure</title>
	 <link href="/atom.xml" rel="alternate" title="thegeez blog" type="application/atom+xml" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
</head>
<body>
<div class="site">
  <div class="title">
    <a href="/">[<span class="lambda">λ</span>] thegeez
    blog</a> <a href="/" class="extra">index</a>
  </div>
  
  <div id="content"><h1 id="post-title">Simple static blog with Clojure</h1>15 Mar 2012
<p>This inaugural post for this Clojure blog describes how it is
created. This blog is hosted by GitHub Pages and the static pages are
generated by a minimal clone for Jekyll written in Clojure and
using Enlive. The code is by no means a replacement for Jekyll, but
can serve as a starting point for people wanting to do the same.</p>

<p>The code for the static pages generator is in the <a href="https://github.com/thegeez/clj-static-blog">clj-static-blog</a> project.</p>

<p><a href="http://pages.github.com">Github Pages</a> can host static pages under username.github.com.
Their suggested method to generate static pages is with <a href="http://github.com/mojombo/jekyll/">Jekyll</a>. As I
could not get Jekyll to run, I had enough of an excuse to use Clojure
and Enlive for the task.</p>

<p>
What clj-static-blog does:
</p><ul>
<li>Put each post in a template with a header and footer</li>
<li>Create an index.html with a list of posts</li>
<li>Create an atom rss feed whit a list of posts</li>
</ul>

<p>It also includes a small webserver to browse the generated pages
locally. GitHub Pages runs Jekyll when changes are pushed to a pages
repository. For this blog the static pages are checked-in,
rather than the sources, because the generator is not run on
GitHub. The Jekyll processing is disabled by the .nojekyll file in
this repo.</p>

<p>The core of clj-static-blog is the Enlive library. <a href="https://github.com/cgrand/enlive">Enlive</a> is a
selector-based (à la CSS) templating library for Clojure, by
  Christophe Grand. The readme of Enlive points to two good
tutorials. Here I just want to highlight to core functionality of
Enlive.</p>

<p>Enlive does selection and transformations. Using only the
selectors Enlive can be used to scrape websites. With the addition of
transformations Enlive can be used for HTML templating.</p>

<pre>
<span class="comment-delimiter">;; </span><span class="comment">html is seq of {:tag :attrs :content}
</span><span class="esk-paren">(</span><span class="keyword">def</span> <span class="function-name">html</span> <span class="esk-paren">(</span>html-resource 
            <span class="esk-paren">(</span>io/file <span class="string">"/source/_postlist.html"</span><span class="esk-paren">)))</span>
<span class="comment-delimiter">;; </span><span class="comment">=&gt; ({:tag :html, :attrs nil, :content ({:tag :body, :attrs ...
</span>  
<span class="comment-delimiter">;; </span><span class="comment">back to textual html again
</span><span class="esk-paren">(</span>emit* html<span class="esk-paren">)</span>
<span class="comment-delimiter">;; </span><span class="comment">=&gt; ("&lt;" "html" "&gt;" "&lt;" "body" "&gt;" "&lt;" "div" " " "id" "=\"" ...
</span>
<span class="comment-delimiter">;; </span><span class="comment">back to a string
</span><span class="esk-paren">(</span><span class="builtin">apply</span> str <span class="esk-paren">(</span>emit* html<span class="esk-paren">))</span>
<span class="comment-delimiter">;; </span><span class="comment">=&gt; "&lt;html&gt;&lt;body&gt;&lt;div id=\"home.....
</span>
<span class="comment-delimiter">;; </span><span class="comment">select a seq of nodes from html with the css-like selector
</span><span class="esk-paren">(</span><span class="keyword">def</span> <span class="function-name">date-node</span> <span class="esk-paren">(</span><span class="type">select</span> html [<span class="builtin">:div.date</span>]<span class="esk-paren">))</span>
<span class="comment-delimiter">;; </span><span class="comment">=&gt; ({:tag :div, :attrs {:class "date"}, :content ("YYYY/MM/DD")})
</span>
<span class="comment-delimiter">;; </span><span class="comment">tranform applies a transformation to a node
</span><span class="esk-paren">(</span>transform date-node
           [<span class="builtin">:div.date</span>]
           <span class="esk-paren">(</span><span class="builtin">fn</span> [match]
             <span class="esk-paren">(</span><span class="builtin">assoc</span> match <span class="builtin">:content</span> <span class="string">"2012/03/15"</span><span class="esk-paren">)))</span>
<span class="comment-delimiter">;; </span><span class="comment">=&gt; ({:tag :div, :attrs {:class "date"}, :content "2012/03/15"})
</span>  
<span class="comment-delimiter">;; </span><span class="comment">the results of a transformation may also be a seq of nodes
</span><span class="esk-paren">(</span>transform date-node
           [<span class="builtin">:div.date</span>]
           <span class="esk-paren">(</span><span class="builtin">fn</span> [match-node]
             [{<span class="builtin">:tag</span> <span class="string">"hr"</span> <span class="builtin">:attrs</span> nil <span class="builtin">:content</span> []}
              {<span class="builtin">:tag</span> <span class="string">"p"</span> <span class="builtin">:attrs</span> nil <span class="builtin">:content</span> <span class="string">"new structure"</span>}]<span class="esk-paren">))</span>
<span class="comment-delimiter">;; </span><span class="comment">=&gt;
  ({:tag "hr", :attrs nil, :content []} 
   {:tag "p", :content "new structure", :attrs nil})
</span>  </pre>
<p>This code is also in clj-static-blog/src/clj_static_blog/core.clj.</p>





</div>
  <div class="footer">
    <div class="contact">
      <p>GitHub: <a href="https://github.com/thegeez">thegeez</a></p>
    </div> 
    <div class="contact">
      <p>Twitter: <a href="http://twitter.com/thegeez">@thegeez</a></p>
    </div>
    <div class="contact">
      <p><a href="/atom.xml">rss</a></p>
    </div>
    <div class="contact">
      <p><a href="/#about">about</a></p>
    </div>
  </div>
</div>
</body>

</html>