<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en-us" xml:lang="en">
<head>
   <meta content="text/html; charset=utf-8" http-equiv="content-type" />
   <title>thegeez blog - Playing "Racket Gin Rummy in ClojureScript" with
  Clojure</title>
	 <link type="application/atom+xml" title="thegeez blog" rel="alternate" href="/atom.xml" />

   <!-- Homepage CSS -->
   <link media="screen, projection" type="text/css" href="/css/screen.css" rel="stylesheet" />
</head>
<body>
<div class="site">
  <div class="title">
    <a href="/">[<span class="lambda">Î»</span>] thegeez
    blog</a> <a class="extra" href="/">index</a>
  </div>
  
  <div id="content"><h1 id="post-title">Playing "Racket Gin Rummy in ClojureScript" with
  Clojure</h1>01 Jun 2012

<p>In 2010 I built my first real Clojure application. It was a tool to
execute semantic specifications of modeling languages and was part of
my master thesis. Before I decided
to use Clojure for this tool I built a little program to test the
waters. This program was <a href="https://github.com/thegeez/clj-ginbot">GinBot</a>.</p>

<p>Whilst dabbling with functional programming languages I tried PLT
Scheme (now <a href="http://racket-lang.org">PLT Racket</a>). As part of the DrScheme editor came a couple
of example games. My favorite is the Gin Rummy card game. The object of this game is to make a hand of 10 cards,
  consisting of a set of four cards and two sets of three cards. Players take turns and can choose to pick the top card of the
  discard pile or a face down card from the deck. For more information see the
  rules for Gin Rummy in the <a href="http://docs.racket-lang.org/games/ginrummy.html"> Racket
  documentation</a>.</p>

<p><a href="https://github.com/thegeez/clj-ginbot">GinBot</a> is a robot in software form that plays the Gin Rummy game
against the computer opponent, using the strategy of the opponent,
which is part of the available source in DrScheme.</p>


<object style="height: 390px; width: 640px"><param value="http://www.youtube.com/v/3mybLKYsmxU?version=3&amp;feature=player_detailpage" name="movie"></param><param value="true" name="allowFullScreen"></param><param value="always" name="allowScriptAccess"></param><embed height="360" width="640" allowscriptaccess="always" allowfullscreen="true" type="application/x-shockwave-flash" src="http://www.youtube.com/v/3mybLKYsmxU?version=3&amp;feature=player_detailpage"></embed></object>
<b>GinBot playing Gin Rummy against a computer opponent by using screenshots and moving the mouse pointer</b>
<br /><br />

<h2>The Java robot</h2>

<p>In order to autonomously let GinBot execute its strategy it needs to
be able to see the cards on the table and be able to move cards
around. Both of these are supported by
the <a href="http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Robot.html">java.awt.Robot</a>
class. The aptly named createScreenCapture() does just that, and the
other methods can move the mouse and execute mouse button presses and
releases.</p>

<p>The final missing piece is to recognize the rank and face of a card
from a screenshot. GinBot does this by first
  finding the borders of a playing card and then looking in the upper
  left corner for the rank number or character and suit symbol. A bit
  of experimentation showed that sampling a couple of pixels was
  sufficient to differentiate all the different cards. The experiment setup for this can be found in <a href="https://github.com/thegeez/clj-ginbot/blob/master/src/clj_ginbot/card.clj">card.clj</a>.</p>

<h2>Gin Rummy in ClojureScript</h2>
<p>To try out ClojureScript I ported the Scheme version to a
  webpage. (See <a href="/2012/03/20/racket_gin_clojurescript.html">Racket
  Gin Rummy in ClojureScript</a>). The code for the opponent strategy
  in the ClojureScript version is verbatim copy of the version from
  the GinBot in Clojure. The latest version of GinBot plays against the
  ClojureScript version rather than the original Scheme version.</p>

<p>As an evaluation of the Clojure language the GinBot program was a great
success. The strategy algorithm benefited greatly from the
datastructures and sequence abstraction in Clojure for readability
over the Scheme version. The Java interop also made Clojure a more
  convenient Java than Java.</p>

<h2>From starting with Clojure to EuroClojure</h2>
<p>Since I began using Clojure with the GinBot project, I have enjoyed
  working with Clojure. This includes starting as a freelance Clojure
  programmer. A particular highlight was the
  first <a href="http://euroclojure.com/2012/">EuroClojure</a>
  conference in London in May 2012. During dinner we were joined by
  Rich Hickey and got to talk about Clojure with its
  creator.</p>
<p>Cheers to many more years enjoying Clojure.</p>
</div>
  <div class="footer">
    <div class="contact">
      <p>GitHub: <a href="https://github.com/thegeez">thegeez</a></p>
    </div> 
    <div class="contact">
      <p>Twitter: <a href="http://twitter.com/thegeez">@thegeez</a></p>
    </div>
    <div class="contact">
      <p><a href="/atom.xml">rss</a></p>
    </div>
    <div class="contact">
      <p><a href="/#about">about</a></p>
    </div>
  </div>
</div>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31804668-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>

</html>